<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500">
  <defs>
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0c0a1d"/>
      <stop offset="50%" style="stop-color:#1a1333"/>
      <stop offset="100%" style="stop-color:#0d1b2a"/>
    </linearGradient>
    
    <linearGradient id="standardGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b6b"/>
      <stop offset="100%" style="stop-color:#ee5a5a"/>
    </linearGradient>
    
    <linearGradient id="flashGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4ecdc4"/>
      <stop offset="100%" style="stop-color:#44a08d"/>
    </linearGradient>
    
    <linearGradient id="matrixGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    
    <filter id="shadow">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-opacity="0.4"/>
    </filter>
    
    <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
    </pattern>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="500" fill="url(#bgGrad)"/>
  <rect width="900" height="500" fill="url(#grid)"/>
  
  <!-- Title -->
  <text x="450" y="45" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="28" font-weight="700" fill="white" filter="url(#glow)">
    Memory-Efficient Attention
  </text>
  <text x="450" y="75" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="14" fill="rgba(255,255,255,0.6)">
    From O(N²) to O(N) — Process 100× longer sequences
  </text>
  
  <!-- Standard Attention Section -->
  <g transform="translate(230, 200)">
    <rect x="-180" y="-80" width="360" height="200" rx="16" fill="rgba(255,107,107,0.1)" stroke="#ff6b6b" stroke-width="2" filter="url(#shadow)"/>
    
    <text y="-50" text-anchor="middle" font-family="system-ui" font-size="16" font-weight="600" fill="#ff6b6b">
      ❌ Standard Attention
    </text>
    
    <!-- N×N Matrix visualization -->
    <g transform="translate(-60, 20)">
      <!-- Full attention matrix (N×N) -->
      <rect x="0" y="0" width="120" height="120" rx="4" fill="rgba(255,107,107,0.3)" stroke="#ff6b6b" stroke-width="1"/>
      
      <!-- Grid lines -->
      <g stroke="rgba(255,255,255,0.1)" stroke-width="0.5">
        <line x1="30" y1="0" x2="30" y2="120"/>
        <line x1="60" y1="0" x2="60" y2="120"/>
        <line x1="90" y1="0" x2="90" y2="120"/>
        <line x1="0" y1="30" x2="120" y2="30"/>
        <line x1="0" y1="60" x2="120" y2="60"/>
        <line x1="0" y1="90" x2="120" y2="90"/>
      </g>
      
      <!-- Fill entire matrix to show O(N²) -->
      <rect x="2" y="2" width="116" height="116" rx="2" fill="url(#standardGrad)" opacity="0.5"/>
      
      <!-- Labels -->
      <text x="60" y="-10" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.7)">N tokens</text>
      <text x="-10" y="60" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.7)" transform="rotate(-90, -10, 60)">N tokens</text>
    </g>
    
    <!-- Memory indicator -->
    <g transform="translate(0, 95)">
      <text y="0" text-anchor="middle" font-family="system-ui" font-size="12" fill="#ff6b6b">Memory: O(N²)</text>
      <text y="18" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.5)">8K tokens → 2GB</text>
    </g>
  </g>
  
  <!-- Arrow -->
  <g transform="translate(450, 200)">
    <path d="M -10 0 L 10 0 M 5 -5 L 10 0 L 5 5" fill="none" stroke="#4ecdc4" stroke-width="3" stroke-linecap="round"/>
    <text y="80" text-anchor="middle" font-family="system-ui" font-size="11" fill="#4ecdc4">Flash Attention</text>
  </g>
  
  <!-- Flash Attention Section -->
  <g transform="translate(670, 200)">
    <rect x="-180" y="-80" width="360" height="200" rx="16" fill="rgba(78,205,196,0.1)" stroke="#4ecdc4" stroke-width="2" filter="url(#shadow)"/>
    
    <text y="-50" text-anchor="middle" font-family="system-ui" font-size="16" font-weight="600" fill="#4ecdc4">
      ✓ Flash Attention
    </text>
    
    <!-- Tiled attention visualization -->
    <g transform="translate(-60, 20)">
      <!-- Matrix outline -->
      <rect x="0" y="0" width="120" height="120" rx="4" fill="none" stroke="rgba(78,205,196,0.3)" stroke-width="1"/>
      
      <!-- Only show active tile -->
      <rect x="30" y="30" width="30" height="30" rx="2" fill="url(#flashGrad)" opacity="0.8">
        <animate attributeName="x" values="0;30;60;90;0;30;60;90;0;30;60;90;0;30;60;90" dur="4s" repeatCount="indefinite"/>
        <animate attributeName="y" values="0;0;0;0;30;30;30;30;60;60;60;60;90;90;90;90" dur="4s" repeatCount="indefinite"/>
      </rect>
      
      <!-- Processed tiles (faded) -->
      <g opacity="0.2">
        <rect x="2" y="2" width="26" height="26" rx="2" fill="#4ecdc4"/>
      </g>
      
      <!-- Grid lines -->
      <g stroke="rgba(255,255,255,0.15)" stroke-width="0.5">
        <line x1="30" y1="0" x2="30" y2="120"/>
        <line x1="60" y1="0" x2="60" y2="120"/>
        <line x1="90" y1="0" x2="90" y2="120"/>
        <line x1="0" y1="30" x2="120" y2="30"/>
        <line x1="0" y1="60" x2="120" y2="60"/>
        <line x1="0" y1="90" x2="120" y2="90"/>
      </g>
      
      <!-- Labels -->
      <text x="60" y="-10" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.7)">Process in tiles</text>
    </g>
    
    <!-- Memory indicator -->
    <g transform="translate(0, 95)">
      <text y="0" text-anchor="middle" font-family="system-ui" font-size="12" fill="#4ecdc4">Memory: O(N)</text>
      <text y="18" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.5)">8K tokens → 8MB</text>
    </g>
  </g>
  
  <!-- Formula Box -->
  <g transform="translate(450, 380)">
    <rect x="-300" y="-30" width="600" height="60" rx="10" fill="rgba(102,126,234,0.15)" stroke="rgba(102,126,234,0.4)" stroke-width="1"/>
    
    <text y="-5" text-anchor="middle" font-family="system-ui" font-size="13" fill="rgba(255,255,255,0.9)">
      Attention(Q, K, V) = softmax(QK<tspan baseline-shift="super" font-size="9">T</tspan> / √d) · V
    </text>
    <text y="18" text-anchor="middle" font-family="system-ui" font-size="11" fill="rgba(255,255,255,0.5)">
      Same output, 99% less memory via tiling + online softmax
    </text>
  </g>
  
  <!-- Stats Bar -->
  <g transform="translate(450, 460)">
    <g transform="translate(-250, 0)">
      <text y="0" text-anchor="middle" font-family="system-ui" font-size="20" font-weight="700" fill="#4ecdc4">2-4×</text>
      <text y="18" text-anchor="middle" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.5)">Faster</text>
    </g>
    
    <g transform="translate(0, 0)">
      <text y="0" text-anchor="middle" font-family="system-ui" font-size="20" font-weight="700" fill="#667eea">99%</text>
      <text y="18" text-anchor="middle" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.5)">Memory Saved</text>
    </g>
    
    <g transform="translate(250, 0)">
      <text y="0" text-anchor="middle" font-family="system-ui" font-size="20" font-weight="700" fill="#f093fb">100K+</text>
      <text y="18" text-anchor="middle" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.5)">Token Sequences</text>
    </g>
  </g>
</svg>
