<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="currentColor"/></marker>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="currentColor"/></marker>
    <linearGradient id="bgGrad4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f0f1a"/>
      <stop offset="100%" style="stop-color:#1a1a2e"/>
    </linearGradient>
    
    <linearGradient id="ddpGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#22c55e"/>
      <stop offset="100%" style="stop-color:#16a34a"/>
    </linearGradient>
    
    <linearGradient id="fsdpGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#1d4ed8"/>
    </linearGradient>
    
    <linearGradient id="tensorGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    
    <linearGradient id="pipelineGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ec4899"/>
      <stop offset="100%" style="stop-color:#be185d"/>
    </linearGradient>
    
    <filter id="shadow4">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="500" fill="url(#bgGrad4)"/>
  
  <!-- Title -->
  <text x="450" y="40" text-anchor="middle" font-family="system-ui" font-size="22" font-weight="600" fill="white">
    Parallelism Strategies Comparison
  </text>
  
  <!-- Data Parallelism -->
  <g transform="translate(120, 160)">
    <rect x="-100" y="-60" width="200" height="180" rx="12" fill="rgba(34,197,94,0.1)" stroke="#22c55e" stroke-width="2" filter="url(#shadow4)"/>
    <text y="-75" text-anchor="middle" font-family="system-ui" font-size="14" font-weight="600" fill="#4ade80">Data Parallel (DDP)</text>
    
    <!-- Model replicas -->
    <g transform="translate(0, 0)">
      <!-- GPU 0 -->
      <rect x="-80" y="-30" width="70" height="50" rx="4" fill="url(#ddpGrad)" opacity="0.8"/>
      <text x="-45" y="-8" text-anchor="middle" font-family="system-ui" font-size="8" fill="white">Full Model</text>
      <text x="-45" y="8" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.7)">GPU 0</text>
      
      <!-- GPU 1 -->
      <rect x="10" y="-30" width="70" height="50" rx="4" fill="url(#ddpGrad)" opacity="0.8"/>
      <text x="45" y="-8" text-anchor="middle" font-family="system-ui" font-size="8" fill="white">Full Model</text>
      <text x="45" y="8" text-anchor="middle" font-family="monospace" font-size="7" fill="rgba(255,255,255,0.7)">GPU 1</text>
      
      <!-- Data indicators -->
      <text x="-45" y="40" text-anchor="middle" font-family="system-ui" font-size="8" fill="rgba(255,255,255,0.5)">Data[0:N/2]</text>
      <text x="45" y="40" text-anchor="middle" font-family="system-ui" font-size="8" fill="rgba(255,255,255,0.5)">Data[N/2:N]</text>
    </g>
    
    <!-- Description -->
    <text y="80" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.6)">Same model, different data</text>
    <text y="95" text-anchor="middle" font-family="system-ui" font-size="9" fill="#4ade80">✓ Simple, efficient</text>
  </g>
  
  <!-- FSDP / ZeRO -->
  <g transform="translate(340, 160)">
    <rect x="-100" y="-60" width="200" height="180" rx="12" fill="rgba(59,130,246,0.1)" stroke="#3b82f6" stroke-width="2" filter="url(#shadow4)"/>
    <text y="-75" text-anchor="middle" font-family="system-ui" font-size="14" font-weight="600" fill="#60a5fa">FSDP / ZeRO</text>
    
    <!-- Sharded model -->
    <g transform="translate(0, 0)">
      <!-- GPU 0 - partial -->
      <rect x="-80" y="-30" width="70" height="25" rx="4" fill="url(#fsdpGrad)" opacity="0.8"/>
      <text x="-45" y="-12" text-anchor="middle" font-family="system-ui" font-size="8" fill="white">Shard 0</text>
      <rect x="-80" y="0" width="70" height="20" rx="4" fill="rgba(59,130,246,0.3)"/>
      <text x="-45" y="14" text-anchor="middle" font-family="monospace" font-size="6" fill="rgba(255,255,255,0.5)">gather on demand</text>
      
      <!-- GPU 1 - partial -->
      <rect x="10" y="-30" width="70" height="25" rx="4" fill="url(#fsdpGrad)" opacity="0.8"/>
      <text x="45" y="-12" text-anchor="middle" font-family="system-ui" font-size="8" fill="white">Shard 1</text>
      <rect x="10" y="0" width="70" height="20" rx="4" fill="rgba(59,130,246,0.3)"/>
      <text x="45" y="14" text-anchor="middle" font-family="monospace" font-size="6" fill="rgba(255,255,255,0.5)">gather on demand</text>
    </g>
    
    <!-- Description -->
    <text y="50" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.6)">Model sharded across GPUs</text>
    <text y="80" text-anchor="middle" font-family="system-ui" font-size="9" fill="#60a5fa">✓ Memory efficient</text>
    <text y="95" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">More communication</text>
  </g>
  
  <!-- Tensor Parallelism -->
  <g transform="translate(560, 160)">
    <rect x="-100" y="-60" width="200" height="180" rx="12" fill="rgba(245,158,11,0.1)" stroke="#f59e0b" stroke-width="2" filter="url(#shadow4)"/>
    <text y="-75" text-anchor="middle" font-family="system-ui" font-size="14" font-weight="600" fill="#fbbf24">Tensor Parallel</text>
    
    <!-- Split matrix -->
    <g transform="translate(0, -10)">
      <!-- Matrix visualization -->
      <rect x="-70" y="-25" width="60" height="50" rx="4" fill="url(#tensorGrad)" opacity="0.8"/>
      <text x="-40" y="5" text-anchor="middle" font-family="monospace" font-size="8" fill="white">W[:,:d/2]</text>
      
      <rect x="10" y="-25" width="60" height="50" rx="4" fill="url(#tensorGrad)" opacity="0.8"/>
      <text x="40" y="5" text-anchor="middle" font-family="monospace" font-size="8" fill="white">W[:,d/2:]</text>
      
      <!-- GPU labels -->
      <text x="-40" y="40" text-anchor="middle" font-family="system-ui" font-size="8" fill="rgba(255,255,255,0.5)">GPU 0</text>
      <text x="40" y="40" text-anchor="middle" font-family="system-ui" font-size="8" fill="rgba(255,255,255,0.5)">GPU 1</text>
    </g>
    
    <!-- Description -->
    <text y="70" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.6)">Split weight matrices</text>
    <text y="85" text-anchor="middle" font-family="system-ui" font-size="9" fill="#fbbf24">✓ Very wide layers</text>
    <text y="100" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">High bandwidth needed</text>
  </g>
  
  <!-- Pipeline Parallelism -->
  <g transform="translate(780, 160)">
    <rect x="-100" y="-60" width="200" height="180" rx="12" fill="rgba(236,72,153,0.1)" stroke="#ec4899" stroke-width="2" filter="url(#shadow4)"/>
    <text y="-75" text-anchor="middle" font-family="system-ui" font-size="14" font-weight="600" fill="#f472b6">Pipeline Parallel</text>
    
    <!-- Pipeline stages -->
    <g transform="translate(0, -10)">
      <!-- Stage 0 -->
      <rect x="-80" y="-25" width="35" height="50" rx="4" fill="url(#pipelineGrad)" opacity="0.8"/>
      <text x="-62" y="5" text-anchor="middle" font-family="system-ui" font-size="7" fill="white">L0-L3</text>
      
      <!-- Stage 1 -->
      <rect x="-40" y="-25" width="35" height="50" rx="4" fill="url(#pipelineGrad)" opacity="0.7"/>
      <text x="-22" y="5" text-anchor="middle" font-family="system-ui" font-size="7" fill="white">L4-L7</text>
      
      <!-- Stage 2 -->
      <rect x="0" y="-25" width="35" height="50" rx="4" fill="url(#pipelineGrad)" opacity="0.6"/>
      <text x="18" y="5" text-anchor="middle" font-family="system-ui" font-size="7" fill="white">L8-L11</text>
      
      <!-- Stage 3 -->
      <rect x="40" y="-25" width="35" height="50" rx="4" fill="url(#pipelineGrad)" opacity="0.5"/>
      <text x="58" y="5" text-anchor="middle" font-family="system-ui" font-size="7" fill="white">L12-15</text>
      
      <!-- Arrows -->
      <path d="M -43 0 L -40 0 M 0 0 L 3 0 M 37 0 L 40 0" stroke="white" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
    </g>
    
    <!-- Description -->
    <text y="60" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.6)">Sequential layer groups</text>
    <text y="85" text-anchor="middle" font-family="system-ui" font-size="9" fill="#f472b6">✓ Very deep models</text>
    <text y="100" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">Bubble overhead</text>
  </g>
  
  <!-- Comparison Table -->
  <g transform="translate(450, 380)">
    <rect x="-420" y="-30" width="840" height="100" rx="10" fill="rgba(255,255,255,0.03)" stroke="rgba(255,255,255,0.1)"/>
    
    <!-- Headers -->
    <text x="-350" y="-10" font-family="system-ui" font-size="10" font-weight="600" fill="rgba(255,255,255,0.7)">Strategy</text>
    <text x="-200" y="-10" font-family="system-ui" font-size="10" font-weight="600" fill="rgba(255,255,255,0.7)">Memory/GPU</text>
    <text x="-50" y="-10" font-family="system-ui" font-size="10" font-weight="600" fill="rgba(255,255,255,0.7)">Communication</text>
    <text x="120" y="-10" font-family="system-ui" font-size="10" font-weight="600" fill="rgba(255,255,255,0.7)">Best For</text>
    <text x="310" y="-10" font-family="system-ui" font-size="10" font-weight="600" fill="rgba(255,255,255,0.7)">Complexity</text>
    
    <!-- DDP Row -->
    <text x="-350" y="15" font-family="system-ui" font-size="10" fill="#4ade80">DDP</text>
    <text x="-200" y="15" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">Full model</text>
    <text x="-50" y="15" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">Low (gradients)</text>
    <text x="120" y="15" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">Model fits 1 GPU</text>
    <text x="310" y="15" font-family="system-ui" font-size="10" fill="#4ade80">Simple</text>
    
    <!-- FSDP Row -->
    <text x="-350" y="35" font-family="system-ui" font-size="10" fill="#60a5fa">FSDP</text>
    <text x="-200" y="35" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">Model/N</text>
    <text x="-50" y="35" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">Medium</text>
    <text x="120" y="35" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">Large models</text>
    <text x="310" y="35" font-family="system-ui" font-size="10" fill="#fbbf24">Moderate</text>
    
    <!-- Tensor Row -->
    <text x="-350" y="55" font-family="system-ui" font-size="10" fill="#fbbf24">Tensor</text>
    <text x="-200" y="55" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">Partial layers</text>
    <text x="-50" y="55" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">High (per layer)</text>
    <text x="120" y="55" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.6)">Wide layers</text>
    <text x="310" y="55" font-family="system-ui" font-size="10" fill="#f59e0b">Complex</text>
  </g>
</svg>

