<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="currentColor"/></marker>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="currentColor"/></marker>
    <linearGradient id="bgGrad5" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f0f1a"/>
      <stop offset="100%" style="stop-color:#1a1a2e"/>
    </linearGradient>
    
    <linearGradient id="shard0" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f093fb"/>
      <stop offset="100%" style="stop-color:#f5576c"/>
    </linearGradient>
    
    <linearGradient id="shard1" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe"/>
      <stop offset="100%" style="stop-color:#00f2fe"/>
    </linearGradient>
    
    <linearGradient id="shard2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#43e97b"/>
      <stop offset="100%" style="stop-color:#38f9d7"/>
    </linearGradient>
    
    <linearGradient id="shard3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fa709a"/>
      <stop offset="100%" style="stop-color:#fee140"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="400" fill="url(#bgGrad5)"/>
  
  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" font-family="system-ui" font-size="20" font-weight="600" fill="white">
    FSDP: Fully Sharded Data Parallelism
  </text>
  <text x="400" y="55" text-anchor="middle" font-family="system-ui" font-size="12" fill="rgba(255,255,255,0.5)">
    Model parameters distributed across GPUs, gathered on-demand
  </text>
  
  <!-- Full Model (Before) -->
  <g transform="translate(150, 150)">
    <text y="-60" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="rgba(255,255,255,0.7)">Standard: Full Model Per GPU</text>
    
    <rect x="-100" y="-40" width="200" height="80" rx="8" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.2)"/>
    
    <!-- Full model representation -->
    <rect x="-90" y="-30" width="45" height="60" rx="4" fill="url(#shard0)" opacity="0.7"/>
    <rect x="-40" y="-30" width="45" height="60" rx="4" fill="url(#shard1)" opacity="0.7"/>
    <rect x="10" y="-30" width="45" height="60" rx="4" fill="url(#shard2)" opacity="0.7"/>
    <rect x="60" y="-30" width="30" height="60" rx="4" fill="url(#shard3)" opacity="0.7"/>
    
    <text y="55" text-anchor="middle" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.5)">~40GB per GPU</text>
    <text y="70" text-anchor="middle" font-family="system-ui" font-size="9" fill="#f87171">× 4 GPUs = 160GB total</text>
  </g>
  
  <!-- Arrow -->
  <g transform="translate(320, 150)">
    <path d="M 0 0 L 60 0" stroke="rgba(255,255,255,0.4)" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
    <text y="20" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">FSDP</text>
  </g>
  
  <!-- Sharded Model (After) -->
  <g transform="translate(550, 150)">
    <text y="-60" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="rgba(255,255,255,0.7)">FSDP: Sharded Across GPUs</text>
    
    <!-- 4 GPUs with shards -->
    <g transform="translate(-150, 0)">
      <rect x="-30" y="-40" width="60" height="80" rx="6" fill="rgba(240,147,251,0.15)" stroke="#f093fb" stroke-width="1"/>
      <rect x="-20" y="-30" width="40" height="60" rx="4" fill="url(#shard0)" opacity="0.8"/>
      <text y="55" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">GPU 0</text>
    </g>
    
    <g transform="translate(-50, 0)">
      <rect x="-30" y="-40" width="60" height="80" rx="6" fill="rgba(79,172,254,0.15)" stroke="#4facfe" stroke-width="1"/>
      <rect x="-20" y="-30" width="40" height="60" rx="4" fill="url(#shard1)" opacity="0.8"/>
      <text y="55" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">GPU 1</text>
    </g>
    
    <g transform="translate(50, 0)">
      <rect x="-30" y="-40" width="60" height="80" rx="6" fill="rgba(67,233,123,0.15)" stroke="#43e97b" stroke-width="1"/>
      <rect x="-20" y="-30" width="40" height="60" rx="4" fill="url(#shard2)" opacity="0.8"/>
      <text y="55" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">GPU 2</text>
    </g>
    
    <g transform="translate(150, 0)">
      <rect x="-30" y="-40" width="60" height="80" rx="6" fill="rgba(250,112,154,0.15)" stroke="#fa709a" stroke-width="1"/>
      <rect x="-20" y="-30" width="40" height="60" rx="4" fill="url(#shard3)" opacity="0.8"/>
      <text y="55" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">GPU 3</text>
    </g>
    
    <text y="85" text-anchor="middle" font-family="system-ui" font-size="10" fill="#4ade80">~10GB per GPU</text>
  </g>
  
  <!-- ZeRO Stages Comparison -->
  <g transform="translate(400, 310)">
    <rect x="-350" y="-50" width="700" height="100" rx="10" fill="rgba(255,255,255,0.03)" stroke="rgba(255,255,255,0.1)"/>
    
    <text y="-30" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="rgba(255,255,255,0.7)">ZeRO Optimization Stages</text>
    
    <!-- Stage 1 -->
    <g transform="translate(-250, 15)">
      <rect x="-50" y="-20" width="100" height="40" rx="6" fill="rgba(102,126,234,0.2)" stroke="#667eea"/>
      <text y="-2" text-anchor="middle" font-family="system-ui" font-size="10" font-weight="600" fill="#a5b4fc">Stage 1</text>
      <text y="12" text-anchor="middle" font-family="system-ui" font-size="8" fill="rgba(255,255,255,0.5)">Optimizer sharding</text>
    </g>
    
    <!-- Stage 2 -->
    <g transform="translate(-80, 15)">
      <rect x="-50" y="-20" width="100" height="40" rx="6" fill="rgba(79,172,254,0.2)" stroke="#4facfe"/>
      <text y="-2" text-anchor="middle" font-family="system-ui" font-size="10" font-weight="600" fill="#7fccff">Stage 2</text>
      <text y="12" text-anchor="middle" font-family="system-ui" font-size="8" fill="rgba(255,255,255,0.5)">+ Gradient sharding</text>
    </g>
    
    <!-- Stage 3 -->
    <g transform="translate(90, 15)">
      <rect x="-50" y="-20" width="100" height="40" rx="6" fill="rgba(67,233,123,0.2)" stroke="#43e97b"/>
      <text y="-2" text-anchor="middle" font-family="system-ui" font-size="10" font-weight="600" fill="#86efac">Stage 3</text>
      <text y="12" text-anchor="middle" font-family="system-ui" font-size="8" fill="rgba(255,255,255,0.5)">+ Parameter sharding</text>
    </g>
    
    <!-- Memory reduction -->
    <g transform="translate(250, 15)">
      <text y="-5" text-anchor="middle" font-family="system-ui" font-size="18" font-weight="700" fill="#4ade80">4-8×</text>
      <text y="15" text-anchor="middle" font-family="system-ui" font-size="9" fill="rgba(255,255,255,0.5)">Memory Reduction</text>
    </g>
  </g>
</svg>

