<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <defs>
    <linearGradient id="bgTA" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f0c29"/>
      <stop offset="100%" style="stop-color:#302b63"/>
    </linearGradient>
    <linearGradient id="spatialGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f43f5e"/>
      <stop offset="100%" style="stop-color:#ec4899"/>
    </linearGradient>
    <linearGradient id="temporalGradTA" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#06b6d4"/>
      <stop offset="100%" style="stop-color:#3b82f6"/>
    </linearGradient>
    <filter id="glowTA">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>
  
  <rect width="800" height="400" fill="url(#bgTA)"/>
  
  <text x="400" y="35" text-anchor="middle" font-family="system-ui" font-size="22" font-weight="700" fill="white" filter="url(#glowTA)">
    Factorized Spatio-Temporal Attention
  </text>
  <text x="400" y="60" text-anchor="middle" font-family="system-ui" font-size="12" fill="rgba(255,255,255,0.6)">
    Process spatial and temporal dimensions separately for efficiency
  </text>
  
  <!-- Video tensor representation -->
  <g transform="translate(100, 200)">
    <text y="-80" text-anchor="middle" font-family="system-ui" font-size="14" font-weight="600" fill="white">Input: [B, T, H, W, C]</text>
    
    <!-- Stacked frames -->
    <rect x="-60" y="-50" width="80" height="60" rx="4" fill="rgba(139,92,246,0.3)" stroke="#a78bfa" stroke-width="1"/>
    <rect x="-50" y="-55" width="80" height="60" rx="4" fill="rgba(139,92,246,0.4)" stroke="#a78bfa" stroke-width="1"/>
    <rect x="-40" y="-60" width="80" height="60" rx="4" fill="rgba(139,92,246,0.5)" stroke="#a78bfa" stroke-width="1"/>
    
    <text y="30" text-anchor="middle" font-family="monospace" font-size="10" fill="rgba(255,255,255,0.6)">Video frames</text>
  </g>
  
  <!-- Arrow to spatial -->
  <path d="M 180,200 L 230,200" stroke="rgba(255,255,255,0.4)" stroke-width="2" marker-end="url(#arrowTA)"/>
  <marker id="arrowTA" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
    <polygon points="0 0, 10 3.5, 0 7" fill="rgba(255,255,255,0.4)"/>
  </marker>
  
  <!-- Spatial Attention -->
  <g transform="translate(320, 200)">
    <rect x="-70" y="-90" width="140" height="180" rx="10" fill="rgba(244,63,94,0.1)" stroke="url(#spatialGrad)" stroke-width="2"/>
    <text y="-65" text-anchor="middle" font-family="system-ui" font-size="13" font-weight="600" fill="#fb7185">Spatial Attention</text>
    
    <!-- Grid showing HÃ—W attention -->
    <g transform="translate(-40, -30)">
      <rect width="80" height="80" rx="4" fill="rgba(244,63,94,0.2)"/>
      <!-- Attention pattern -->
      <g stroke="#f43f5e" stroke-width="1" fill="none" opacity="0.6">
        <line x1="0" y1="20" x2="80" y2="20"/>
        <line x1="0" y1="40" x2="80" y2="40"/>
        <line x1="0" y1="60" x2="80" y2="60"/>
        <line x1="20" y1="0" x2="20" y2="80"/>
        <line x1="40" y1="0" x2="40" y2="80"/>
        <line x1="60" y1="0" x2="60" y2="80"/>
      </g>
      <circle cx="40" cy="40" r="6" fill="#f43f5e" opacity="0.8"/>
    </g>
    
    <text y="75" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.5)">Per frame: (HÃ—W) â†’ (HÃ—W)</text>
  </g>
  
  <!-- Arrow to temporal -->
  <path d="M 410,200 L 470,200" stroke="rgba(255,255,255,0.4)" stroke-width="2" marker-end="url(#arrowTA)"/>
  
  <!-- Temporal Attention -->
  <g transform="translate(560, 200)">
    <rect x="-70" y="-90" width="140" height="180" rx="10" fill="rgba(6,182,212,0.1)" stroke="url(#temporalGradTA)" stroke-width="2"/>
    <text y="-65" text-anchor="middle" font-family="system-ui" font-size="13" font-weight="600" fill="#22d3ee">Temporal Attention</text>
    
    <!-- Timeline showing T attention -->
    <g transform="translate(-50, -20)">
      <line x1="0" y1="40" x2="100" y2="40" stroke="#06b6d4" stroke-width="2"/>
      
      <!-- Frames as dots -->
      <circle cx="10" cy="40" r="8" fill="rgba(6,182,212,0.4)" stroke="#06b6d4"/>
      <circle cx="30" cy="40" r="8" fill="rgba(6,182,212,0.5)" stroke="#06b6d4"/>
      <circle cx="50" cy="40" r="8" fill="#06b6d4" stroke="#06b6d4"/>
      <circle cx="70" cy="40" r="8" fill="rgba(6,182,212,0.5)" stroke="#06b6d4"/>
      <circle cx="90" cy="40" r="8" fill="rgba(6,182,212,0.4)" stroke="#06b6d4"/>
      
      <!-- Attention lines -->
      <g stroke="#22d3ee" stroke-width="1" stroke-dasharray="2,2" opacity="0.5">
        <line x1="50" y1="40" x2="10" y2="40"/>
        <line x1="50" y1="40" x2="30" y2="40"/>
        <line x1="50" y1="40" x2="70" y2="40"/>
        <line x1="50" y1="40" x2="90" y2="40"/>
      </g>
      
      <text x="50" y="70" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.5)">t=0  t=1  t=2  t=3  t=4</text>
    </g>
    
    <text y="75" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.5)">Per pixel: T â†’ T</text>
  </g>
  
  <!-- Arrow to output -->
  <path d="M 650,200 L 700,200" stroke="rgba(255,255,255,0.4)" stroke-width="2" marker-end="url(#arrowTA)"/>
  
  <!-- Output -->
  <g transform="translate(760, 200)">
    <rect x="-40" y="-50" width="80" height="100" rx="8" fill="rgba(34,197,94,0.2)" stroke="#22c55e" stroke-width="2"/>
    <text y="5" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="#4ade80">Output</text>
    <text y="65" text-anchor="middle" font-family="monospace" font-size="9" fill="rgba(255,255,255,0.5)">[B,T,H,W,C]</text>
  </g>
  
  <!-- Efficiency note -->
  <g transform="translate(400, 360)">
    <rect x="-300" y="-20" width="600" height="35" rx="8" fill="rgba(34,197,94,0.1)" stroke="#22c55e"/>
    <text y="3" text-anchor="middle" font-family="system-ui" font-size="11" fill="#4ade80">
      ðŸ’¡ Factorized: O(TÂ·HÂ·W + HÂ·WÂ·T) vs Full 3D: O((TÂ·HÂ·W)Â²) â€” much more efficient!
    </text>
  </g>
</svg>

