<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 500">
  <defs>
    <linearGradient id="bgAnn" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0d0d1a"/>
      <stop offset="100%" style="stop-color:#1a1a35"/>
    </linearGradient>
    
    <linearGradient id="titleAnn" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f5576c"/>
      <stop offset="30%" style="stop-color:#f093fb"/>
      <stop offset="70%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#43e97b"/>
    </linearGradient>
    
    <linearGradient id="highNoise" x1="0%" y1="100%" x2="0%" y2="0%">
      <stop offset="0%" style="stop-color:rgba(245,87,108,0.3)"/>
      <stop offset="100%" style="stop-color:rgba(245,87,108,0.05)"/>
    </linearGradient>
    
    <linearGradient id="medNoise" x1="0%" y1="100%" x2="0%" y2="0%">
      <stop offset="0%" style="stop-color:rgba(240,147,251,0.3)"/>
      <stop offset="100%" style="stop-color:rgba(240,147,251,0.05)"/>
    </linearGradient>
    
    <linearGradient id="lowNoise" x1="0%" y1="100%" x2="0%" y2="0%">
      <stop offset="0%" style="stop-color:rgba(67,233,123,0.3)"/>
      <stop offset="100%" style="stop-color:rgba(67,233,123,0.05)"/>
    </linearGradient>
    
    <filter id="glowAnn">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <marker id="arrowAnn" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#feca57"/>
    </marker>
  </defs>
  
  <rect width="1000" height="500" fill="url(#bgAnn)"/>
  
  <!-- Title -->
  <text x="500" y="40" text-anchor="middle" font-family="Georgia, serif" font-size="24" font-weight="700" fill="url(#titleAnn)" filter="url(#glowAnn)">
    Annealed Langevin Dynamics
  </text>
  <text x="500" y="68" text-anchor="middle" font-family="system-ui" font-size="12" fill="rgba(255,255,255,0.6)">
    Solve multimodality by gradually decreasing noise level: σ₁ > σ₂ > ... > σ_L
  </text>
  
  <!-- Stage 1: High Noise -->
  <g transform="translate(170, 270)">
    <rect x="-120" y="-140" width="240" height="280" rx="12" fill="rgba(245,87,108,0.08)" stroke="#f5576c" stroke-width="1"/>
    
    <text x="0" y="-115" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="#f5576c">
      σ = σ₁ (High Noise)
    </text>
    
    <!-- Blurred, spread out modes -->
    <ellipse cx="-40" cy="0" rx="80" ry="80" fill="url(#highNoise)"/>
    <ellipse cx="40" cy="20" rx="75" ry="75" fill="url(#highNoise)"/>
    
    <!-- The modes are connected -->
    <ellipse cx="0" cy="10" rx="100" ry="70" fill="none" stroke="rgba(245,87,108,0.3)" stroke-width="1" stroke-dasharray="4,2"/>
    
    <!-- Trajectory -->
    <path d="M 80,-60 Q 60,-30 30,0 Q 0,20 -30,10" fill="none" stroke="#f5576c" stroke-width="2"/>
    <circle cx="80" cy="-60" r="5" fill="#f5576c"/>
    <circle cx="-30" cy="10" r="5" fill="#f5576c"/>
    
    <text x="0" y="100" text-anchor="middle" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.5)">
      Modes connected
    </text>
    <text x="0" y="115" text-anchor="middle" font-family="system-ui" font-size="10" fill="#43e97b">
      Easy mixing!
    </text>
  </g>
  
  <!-- Arrow 1 -->
  <g transform="translate(310, 270)">
    <line x1="0" y1="0" x2="60" y2="0" stroke="#feca57" stroke-width="2" marker-end="url(#arrowAnn)"/>
    <text x="30" y="-10" text-anchor="middle" font-family="system-ui" font-size="9" fill="#feca57">decrease σ</text>
  </g>
  
  <!-- Stage 2: Medium Noise -->
  <g transform="translate(500, 270)">
    <rect x="-120" y="-140" width="240" height="280" rx="12" fill="rgba(240,147,251,0.08)" stroke="#f093fb" stroke-width="1"/>
    
    <text x="0" y="-115" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="#f093fb">
      σ = σ_k (Medium)
    </text>
    
    <!-- More separated modes -->
    <ellipse cx="-50" cy="-10" rx="55" ry="55" fill="url(#medNoise)"/>
    <circle cx="-50" cy="-10" r="6" fill="#764ba2" opacity="0.4"/>
    
    <ellipse cx="50" cy="20" rx="50" ry="50" fill="url(#medNoise)"/>
    <circle cx="50" cy="20" r="5" fill="#764ba2" opacity="0.4"/>
    
    <!-- Trajectory continues -->
    <path d="M -30,10 Q -40,0 -45,-5" fill="none" stroke="#f093fb" stroke-width="2"/>
    <circle cx="-30" cy="10" r="4" fill="#f093fb"/>
    <circle cx="-45" cy="-5" r="5" fill="#f093fb"/>
    
    <text x="0" y="100" text-anchor="middle" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.5)">
      Modes separating
    </text>
    <text x="0" y="115" text-anchor="middle" font-family="system-ui" font-size="10" fill="#feca57">
      Refining position
    </text>
  </g>
  
  <!-- Arrow 2 -->
  <g transform="translate(640, 270)">
    <line x1="0" y1="0" x2="60" y2="0" stroke="#feca57" stroke-width="2" marker-end="url(#arrowAnn)"/>
    <text x="30" y="-10" text-anchor="middle" font-family="system-ui" font-size="9" fill="#feca57">decrease σ</text>
  </g>
  
  <!-- Stage 3: Low Noise -->
  <g transform="translate(830, 270)">
    <rect x="-120" y="-140" width="240" height="280" rx="12" fill="rgba(67,233,123,0.08)" stroke="#43e97b" stroke-width="1"/>
    
    <text x="0" y="-115" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="#43e97b">
      σ = σ_L (Low Noise)
    </text>
    
    <!-- Sharp, separated modes -->
    <ellipse cx="-50" cy="-10" rx="35" ry="35" fill="url(#lowNoise)"/>
    <ellipse cx="-50" cy="-10" rx="20" ry="20" fill="rgba(67,233,123,0.3)"/>
    <circle cx="-50" cy="-10" r="8" fill="#43e97b" opacity="0.6"/>
    
    <ellipse cx="50" cy="20" rx="30" ry="30" fill="url(#lowNoise)"/>
    <ellipse cx="50" cy="20" rx="18" ry="18" fill="rgba(67,233,123,0.3)"/>
    <circle cx="50" cy="20" r="6" fill="#43e97b" opacity="0.6"/>
    
    <!-- Final sample -->
    <circle cx="-45" cy="-5" r="4" fill="#43e97b"/>
    <circle cx="-48" cy="-8" r="7" fill="none" stroke="#38f9d7" stroke-width="2"/>
    <text x="-48" y="15" text-anchor="middle" font-family="system-ui" font-size="9" fill="#38f9d7">sample!</text>
    
    <text x="0" y="100" text-anchor="middle" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.5)">
      Sharp modes
    </text>
    <text x="0" y="115" text-anchor="middle" font-family="system-ui" font-size="10" fill="#43e97b">
      Final sample ✓
    </text>
  </g>
  
  <!-- Bottom: Key insight -->
  <g transform="translate(500, 460)">
    <rect x="-430" y="-25" width="860" height="50" rx="10" fill="rgba(0,0,0,0.4)"/>
    
    <text x="0" y="-2" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="white">
      Why annealing works:
    </text>
    <text x="0" y="18" text-anchor="middle" font-family="system-ui" font-size="11" fill="rgba(255,255,255,0.7)">
      <tspan fill="#f5576c">High σ:</tspan> Easy mixing between modes  →  <tspan fill="#f093fb">Medium σ:</tspan> Start focusing  →  <tspan fill="#43e97b">Low σ:</tspan> Accurate final samples
    </text>
  </g>
</svg>

