<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 400">
  <defs>
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0c0a20"/>
      <stop offset="100%" style="stop-color:#1a1640"/>
    </linearGradient>
    
    <linearGradient id="muGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#a78bfa"/>
    </linearGradient>
    
    <linearGradient id="sigmaGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ec4899"/>
      <stop offset="100%" style="stop-color:#f472b6"/>
    </linearGradient>
    
    <linearGradient id="epsilonGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#06b6d4"/>
      <stop offset="100%" style="stop-color:#22d3ee"/>
    </linearGradient>
    
    <linearGradient id="zGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#34d399"/>
    </linearGradient>
    
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
      <feMerge>
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <marker id="arrowPurple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#a78bfa"/>
    </marker>
    
    <marker id="arrowPink" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f472b6"/>
    </marker>
    
    <marker id="arrowCyan" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#22d3ee"/>
    </marker>
    
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34d399"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="400" fill="url(#bgGrad)"/>
  
  <!-- Title -->
  <text x="450" y="40" text-anchor="middle" font-family="system-ui" font-size="24" font-weight="700" fill="white" filter="url(#glow)">
    The Reparameterization Trick
  </text>
  <text x="450" y="65" text-anchor="middle" font-family="system-ui" font-size="12" fill="rgba(255,255,255,0.6)">
    Enabling gradient flow through stochastic sampling
  </text>
  
  <!-- Main Diagram -->
  <g transform="translate(100, 100)">
    
    <!-- Encoder output: Î¼ -->
    <g transform="translate(0, 80)">
      <rect x="-40" y="-40" width="80" height="80" rx="12" fill="rgba(139,92,246,0.2)" stroke="url(#muGrad)" stroke-width="2" filter="url(#glow)"/>
      <text x="0" y="10" text-anchor="middle" font-family="serif" font-size="36" font-style="italic" fill="#c4b5fd">Î¼</text>
      <text x="0" y="60" text-anchor="middle" font-family="system-ui" font-size="11" fill="#a78bfa">mean</text>
    </g>
    
    <!-- Encoder output: Ïƒ -->
    <g transform="translate(0, 200)">
      <rect x="-40" y="-40" width="80" height="80" rx="12" fill="rgba(236,72,153,0.2)" stroke="url(#sigmaGrad)" stroke-width="2" filter="url(#glow)"/>
      <text x="0" y="10" text-anchor="middle" font-family="serif" font-size="36" font-style="italic" fill="#f9a8d4">Ïƒ</text>
      <text x="0" y="60" text-anchor="middle" font-family="system-ui" font-size="11" fill="#f472b6">std dev</text>
    </g>
    
    <!-- External noise: Îµ ~ N(0, I) -->
    <g transform="translate(200, 200)">
      <circle r="40" fill="rgba(6,182,212,0.2)" stroke="url(#epsilonGrad)" stroke-width="2" filter="url(#glow)"/>
      <text x="0" y="10" text-anchor="middle" font-family="serif" font-size="32" font-style="italic" fill="#67e8f9">Îµ</text>
      <text x="0" y="65" text-anchor="middle" font-family="system-ui" font-size="11" fill="#22d3ee">~ N(0, I)</text>
      <text x="0" y="80" text-anchor="middle" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.5)">random noise</text>
    </g>
    
    <!-- Multiplication symbol -->
    <g transform="translate(300, 200)">
      <circle r="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.3)" stroke-width="1"/>
      <text x="0" y="6" text-anchor="middle" font-family="system-ui" font-size="20" fill="white">âŠ™</text>
    </g>
    
    <!-- Arrow from Ïƒ to multiply -->
    <path d="M 60,200 L 275,200" stroke="#f472b6" stroke-width="2" marker-end="url(#arrowPink)"/>
    
    <!-- Arrow from Îµ to multiply -->
    <path d="M 250,200 L 275,200" stroke="#22d3ee" stroke-width="2"/>
    
    <!-- Product: Ïƒ âŠ™ Îµ -->
    <g transform="translate(380, 200)">
      <rect x="-35" y="-30" width="70" height="60" rx="8" fill="rgba(236,72,153,0.15)" stroke="#f472b6" stroke-width="1"/>
      <text x="0" y="10" text-anchor="middle" font-family="serif" font-size="18" font-style="italic" fill="#f9a8d4">Ïƒ âŠ™ Îµ</text>
    </g>
    
    <!-- Arrow from multiply to product -->
    <path d="M 325,200 L 335,200" stroke="rgba(255,255,255,0.5)" stroke-width="2"/>
    
    <!-- Addition symbol -->
    <g transform="translate(480, 140)">
      <circle r="20" fill="rgba(16,185,129,0.2)" stroke="#34d399" stroke-width="2"/>
      <text x="0" y="8" text-anchor="middle" font-family="system-ui" font-size="28" fill="#6ee7b7">+</text>
    </g>
    
    <!-- Arrow from Î¼ to addition -->
    <path d="M 60,80 L 430,80 L 430,120 L 455,140" stroke="#a78bfa" stroke-width="2" fill="none" marker-end="url(#arrowPurple)"/>
    
    <!-- Arrow from product to addition -->
    <path d="M 425,200 L 455,200 L 455,165" stroke="#f472b6" stroke-width="2" fill="none" marker-end="url(#arrowPink)"/>
    
    <!-- Final z output -->
    <g transform="translate(600, 140)">
      <rect x="-50" y="-50" width="100" height="100" rx="16" fill="rgba(16,185,129,0.2)" stroke="url(#zGrad)" stroke-width="3" filter="url(#glow)"/>
      <text x="0" y="15" text-anchor="middle" font-family="serif" font-size="48" font-weight="600" fill="#6ee7b7">z</text>
      <text x="0" y="70" text-anchor="middle" font-family="system-ui" font-size="11" fill="#34d399">latent code</text>
    </g>
    
    <!-- Arrow from addition to z -->
    <path d="M 510,140 L 540,140" stroke="#34d399" stroke-width="2" marker-end="url(#arrowGreen)"/>
    
    <!-- Formula below -->
    <g transform="translate(350, 280)">
      <rect x="-200" y="-10" width="400" height="50" rx="10" fill="rgba(0,0,0,0.4)" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>
      <text x="0" y="25" text-anchor="middle" font-family="serif" font-size="22" fill="white">
        z = Î¼ + Ïƒ âŠ™ Îµ    where Îµ ~ N(0, I)
      </text>
    </g>
  </g>
  
  <!-- Key insight box -->
  <g transform="translate(700, 130)">
    <rect width="180" height="150" rx="10" fill="rgba(16,185,129,0.1)" stroke="#10b981" stroke-width="1"/>
    <text x="90" y="25" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="#6ee7b7">ðŸ’¡ Key Insight</text>
    <text x="15" y="50" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.8)">Gradients flow through</text>
    <text x="15" y="68" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.8)">Î¼ and Ïƒ (deterministic)</text>
    <text x="15" y="95" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.8)">Randomness is external</text>
    <text x="15" y="113" font-family="system-ui" font-size="10" fill="rgba(255,255,255,0.8)">in Îµ (no gradient needed)</text>
    <text x="15" y="140" font-family="system-ui" font-size="10" font-weight="600" fill="#34d399">= Differentiable sampling!</text>
  </g>
</svg>

