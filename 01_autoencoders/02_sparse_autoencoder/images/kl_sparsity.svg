<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <defs>
    <linearGradient id="klBg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#141e30"/>
      <stop offset="100%" style="stop-color:#243b55"/>
    </linearGradient>
    <linearGradient id="curveGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#00c6ff"/>
      <stop offset="100%" style="stop-color:#0072ff"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="400" fill="url(#klBg)" rx="15"/>
  
  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" fill="#ffffff" font-family="Arial, sans-serif" font-size="22" font-weight="bold">KL Divergence Sparsity Penalty</text>
  
  <!-- Formula box -->
  <g transform="translate(200, 55)">
    <rect x="0" y="0" width="400" height="60" rx="10" fill="#1a1a2e" stroke="#00c6ff" stroke-width="2"/>
    <text x="200" y="25" text-anchor="middle" fill="#ffffff" font-size="14">D_KL(ρ || ρ̂_j) = ρ log(ρ/ρ̂_j) + (1-ρ) log((1-ρ)/(1-ρ̂_j))</text>
    <text x="200" y="48" text-anchor="middle" fill="#aaaaaa" font-size="12">ρ = target sparsity (e.g., 0.05), ρ̂_j = average activation of unit j</text>
  </g>
  
  <!-- Graph -->
  <g transform="translate(100, 140)">
    <!-- Axes -->
    <line x1="50" y1="200" x2="550" y2="200" stroke="#ffffff" stroke-width="2"/>
    <line x1="50" y1="0" x2="50" y2="200" stroke="#ffffff" stroke-width="2"/>
    
    <!-- Axis labels -->
    <text x="300" y="235" text-anchor="middle" fill="#ffffff" font-size="14">ρ̂_j (average activation)</text>
    <text x="20" y="100" text-anchor="middle" fill="#ffffff" font-size="14" transform="rotate(-90, 20, 100)">KL Penalty</text>
    
    <!-- X-axis ticks -->
    <text x="50" y="220" text-anchor="middle" fill="#aaaaaa" font-size="11">0</text>
    <text x="150" y="220" text-anchor="middle" fill="#aaaaaa" font-size="11">0.2</text>
    <text x="250" y="220" text-anchor="middle" fill="#aaaaaa" font-size="11">0.4</text>
    <text x="350" y="220" text-anchor="middle" fill="#aaaaaa" font-size="11">0.6</text>
    <text x="450" y="220" text-anchor="middle" fill="#aaaaaa" font-size="11">0.8</text>
    <text x="550" y="220" text-anchor="middle" fill="#aaaaaa" font-size="11">1.0</text>
    
    <!-- KL curve (U-shaped, minimum at ρ = 0.05) -->
    <path d="M 55 50 
             Q 65 120 75 165
             Q 80 180 85 190
             Q 90 195 100 198
             Q 150 200 200 180
             Q 300 140 400 90
             Q 450 60 500 35
             Q 530 20 545 10" 
          stroke="url(#curveGrad)" stroke-width="4" fill="none"/>
    
    <!-- Minimum point -->
    <circle cx="75" cy="198" r="8" fill="#00ff88" stroke="#ffffff" stroke-width="2"/>
    <line x1="75" y1="0" x2="75" y2="198" stroke="#00ff88" stroke-width="2" stroke-dasharray="5,5"/>
    
    <!-- Target rho annotation -->
    <g transform="translate(75, -15)">
      <rect x="-35" y="-15" width="70" height="25" rx="5" fill="#00ff88"/>
      <text x="0" y="2" text-anchor="middle" fill="#000000" font-size="11" font-weight="bold">ρ = 0.05</text>
    </g>
    
    <!-- Zones -->
    <rect x="50" y="0" width="100" height="200" fill="#00ff88" opacity="0.1"/>
    <rect x="150" y="0" width="400" height="200" fill="#ff6b6b" opacity="0.1"/>
    
    <!-- Zone labels -->
    <text x="100" y="185" text-anchor="middle" fill="#00ff88" font-size="11">Sparse ✓</text>
    <text x="350" y="185" text-anchor="middle" fill="#ff6b6b" font-size="11">Too active ✗</text>
  </g>
  
  <!-- Explanation boxes -->
  <g transform="translate(620, 160)">
    <rect x="0" y="0" width="150" height="100" rx="8" fill="#1a1a2e" stroke="#00c6ff"/>
    <text x="75" y="20" text-anchor="middle" fill="#00ff88" font-size="12" font-weight="bold">If ρ̂_j > ρ</text>
    <text x="75" y="40" text-anchor="middle" fill="#ffffff" font-size="11">Penalty ↑</text>
    <text x="75" y="60" text-anchor="middle" fill="#aaaaaa" font-size="10">Push activations</text>
    <text x="75" y="75" text-anchor="middle" fill="#aaaaaa" font-size="10">DOWN ↓</text>
  </g>
  
  <g transform="translate(620, 270)">
    <rect x="0" y="0" width="150" height="100" rx="8" fill="#1a1a2e" stroke="#ff6b6b"/>
    <text x="75" y="20" text-anchor="middle" fill="#ff6b6b" font-size="12" font-weight="bold">If ρ̂_j &lt; ρ</text>
    <text x="75" y="40" text-anchor="middle" fill="#ffffff" font-size="11">Penalty ↑</text>
    <text x="75" y="60" text-anchor="middle" fill="#aaaaaa" font-size="10">Push activations</text>
    <text x="75" y="75" text-anchor="middle" fill="#aaaaaa" font-size="10">UP ↑</text>
  </g>
</svg>


